<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>HTML5-Snake</title>
    <meta name="description" content="Demo of the HTML5 version of the classic game: Snake">
    <style>
        #snake {
            border: 1px solid black;
            background-color: whitesmoke;
        }
    </style>
</head>

<body>
    <canvas id="snake"></canvas>
    <script type="text/javascript">
        /**
         * HTML5-Snake v1.0.0
         * This is a HTML5 version of the classic game: Snake
         *
         * @author      Christopher Viray
         * @copyright   (c) 2018 Christopher Viray
         * @license     MIT
         * @version     1.0.0
         */

        // variables
        var canvas = document.getElementById('snake');
        var context = canvas.getContext('2d');
        var boardWidth = 800;
        var boardHeight = 800;
        var squareWidth = 40;
        var squareHeight = 40;
        var snake = [];
        var food = { 'x': null, 'y': null };
        var turns = [];
        var queue = [];
        var score = 0;
        var gameover = false;

        // function to initialize the game
        function init() {
            // setup board layout
            canvas.setAttribute('width', boardWidth + 'px');
            canvas.setAttribute('height', boardHeight + 'px');

            // setup food
            createFood();

            // setup snake
            snake.push({ 'x': 0, 'y': 0 });

            // set default starting direction
            turns.push('right');

            // add listener for arrow keys
            document.onkeydown = this.checkForArrowKeys;

            // run game
            setInterval(runGame, 200);
        }

        // function to draw a single square on the board
        function drawSquare(x, y, color) {
            context.beginPath();
            context.rect(x, y, (squareWidth - 1), (squareHeight - 1));
            context.fillStyle = color;
            context.fill();
            context.lineWidth = 1;
            context.strokeStyle = 'black';
            context.stroke();
        }

        // function to randomly create a food square on the board
        function createFood() {
            food.x = Math.floor(Math.random() * (boardWidth / squareWidth)) * squareWidth;
            food.y = Math.floor(Math.random() * (boardHeight / squareHeight)) * squareHeight;
        }

        // function to add-on to snake
        function addToSnake(x, y) {
            snake.push({ 'x': x, 'y': y });
            createFood();
        }

        // function to update the position of the snake
        function updateSnake() {

            // check direction
            var offsetX = 0;
            var offsetY = 0;
            switch (turns[0]) {
                case 'left':
                    offsetX = -squareWidth;
                    break;
                case 'right':
                    offsetX = squareWidth;
                    break;
                case 'up':
                    offsetY = -squareHeight;
                    break;
                case 'down':
                    offsetY = squareHeight;
                    break;
            }

            // loop thru snake array
            for (var i = 0; i < snake.length; i++) {
                var x = snake[i].x + offsetX;
                var y = snake[i].y + offsetY;

                // check for x boundary
                if (x >= boardWidth) {
                    x = 0;
                } else if (x < 0) {
                    x = boardWidth - squareWidth;
                }
                snake[i].x = x;

                // check for y boundary
                if (y >= boardHeight) {
                    y = 0;
                } else if (y < 0) {
                    y = boardHeight - squareHeight;
                }
                snake[i].y = y;

                // check if catch food
                if (x === food.x && y === food.y) {
                    addToSnake(snake[i].x, snake[i].y);
                }
            }
        }

        // function to handle keyboard presses
        function checkForArrowKeys(event) {
            event = event || window.event;

            // defensive check
            if (event == undefined || event.keyCode == undefined) {
                return;
            }

            // update direction depending on arrow key pressed
            var direction = null;
            switch (event.keyCode) {
                case 37:
                    direction = 'left';
                    break;
                case 38:
                    direction = 'up';
                    break;
                case 39:
                    direction = 'right';
                    break;
                case 40:
                    direction = 'down';
                    break;
            }

            // check direction
            if (direction && direction !== turns[0]) {
                turns.unshift(direction);
            }
        }

        // function to render the whole game: food/snake
        function render() {

            // render food
            drawSquare(food.x, food.y, 'red');

            // render snake
            for (var i = 0; i < snake.length; i++) {
                drawSquare(snake[i].x, snake[i].y, 'green');
            }
        }

        // function to run the game in a giant loop
        function runGame() {
            // clear/reset the board
            context.clearRect(0, 0, boardWidth, boardHeight);

            // update the snake positions for the next render
            updateSnake();

            // render the whole game
            render();
        }

        // init and start the game
        init();
    </script>
</body>

</html>